# Paper Scraper Environment Configuration
# Copy this file to .env and fill in your values
#
# IMPORTANT: All values marked as REQUIRED must be set before starting
#            the application. Generate secrets with: openssl rand -hex 32

# =============================================================================
# Docker Compose Settings (used by docker-compose.yml)
# =============================================================================
# These are REQUIRED for docker-compose to start
POSTGRES_DB=paperscraper
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-secure-postgres-password  # REQUIRED - change this!
POSTGRES_PORT=5432

REDIS_PASSWORD=  # Optional - leave empty for no password in development
REDIS_PORT=6379

MINIO_ROOT_USER=minio  # REQUIRED
MINIO_ROOT_PASSWORD=your-secure-minio-password  # REQUIRED - min 8 chars!
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001

API_PORT=8000
FRONTEND_PORT=3000
VITE_API_URL=http://localhost:8000

# =============================================================================
# Application Settings
# =============================================================================
APP_NAME=PaperScraper
APP_ENV=development  # development | staging | production
DEBUG=true
API_V1_PREFIX=/api/v1
LOG_LEVEL=INFO
ENVIRONMENT=development

# =============================================================================
# Database Configuration (PostgreSQL + pgvector)
# These are auto-constructed in docker-compose, but can be overridden
# =============================================================================
# DATABASE_URL=postgresql+asyncpg://postgres:your-password@localhost:5432/paperscraper
# DATABASE_URL_SYNC=postgresql://postgres:your-password@localhost:5432/paperscraper
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30

# =============================================================================
# Redis Configuration (for arq job queue + caching)
# =============================================================================
# REDIS_URL=redis://localhost:6379/0  # Auto-constructed in docker-compose

# =============================================================================
# JWT Authentication - CRITICAL SECURITY
# =============================================================================
# Generate with: openssl rand -hex 32
# REQUIRED in production - app will fail to start without this!
JWT_SECRET_KEY=generate-me-with-openssl-rand-hex-32
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# =============================================================================
# Object Storage (MinIO / S3-compatible)
# =============================================================================
S3_ENDPOINT=http://localhost:9000
# S3_ACCESS_KEY and S3_SECRET_KEY are set from MINIO_ROOT_USER/PASSWORD in docker-compose
S3_BUCKET_NAME=paperscraper
S3_REGION=us-east-1

# =============================================================================
# Email (Resend)
# =============================================================================
# Get API key from: https://resend.com/api-keys
RESEND_API_KEY=
EMAIL_FROM_ADDRESS=Paper Scraper <noreply@paperscraper.app>

# Token expiry settings
EMAIL_VERIFICATION_TOKEN_EXPIRE_MINUTES=1440  # 24 hours
PASSWORD_RESET_TOKEN_EXPIRE_MINUTES=60        # 1 hour
TEAM_INVITATION_TOKEN_EXPIRE_DAYS=7           # 7 days

# =============================================================================
# Frontend URL (for email links)
# =============================================================================
FRONTEND_URL=http://localhost:3000

# =============================================================================
# LLM Configuration (Provider-agnostic)
# =============================================================================
LLM_PROVIDER=openai  # openai | anthropic | ollama | azure
LLM_MODEL=gpt-4o-mini
LLM_EMBEDDING_MODEL=text-embedding-3-small
LLM_TEMPERATURE=0.3
LLM_MAX_TOKENS=4096

# OpenAI (required if LLM_PROVIDER=openai)
OPENAI_API_KEY=sk-your-openai-api-key
# OPENAI_ORG_ID=org-xxx

# Anthropic (optional, if LLM_PROVIDER=anthropic)
# ANTHROPIC_API_KEY=sk-ant-your-anthropic-api-key

# Azure OpenAI (optional, if LLM_PROVIDER=azure)
# AZURE_OPENAI_API_KEY=
# AZURE_OPENAI_ENDPOINT=https://your-resource.openai.azure.com
# AZURE_OPENAI_API_VERSION=2024-02-15-preview
# AZURE_OPENAI_DEPLOYMENT=gpt-4o-mini

# Ollama (optional, if LLM_PROVIDER=ollama)
# OLLAMA_BASE_URL=http://localhost:11434

# =============================================================================
# External Open APIs (Data Sources)
# =============================================================================
# OpenAlex - Primary paper/author metadata (free, no key required)
# Use your real email for polite pool access (higher rate limits)
OPENALEX_EMAIL=your-email@example.com

# EPO OPS - Patent data (free tier: 4GB/week, requires registration)
# Register at: https://developers.epo.org/
# EPO_OPS_KEY=
# EPO_OPS_SECRET=

# arXiv - Preprints (free, no key required)
# Uses default: http://export.arxiv.org/api

# PubMed/NCBI (optional, API key increases rate limits)
# Register at: https://www.ncbi.nlm.nih.gov/account/
# PUBMED_API_KEY=

# Crossref (free, polite pool with email)
CROSSREF_EMAIL=your-email@example.com

# Semantic Scholar (optional, API key for higher limits)
# Register at: https://www.semanticscholar.org/product/api
# SEMANTIC_SCHOLAR_API_KEY=

# GitHub API (optional: increases rate limit from 60/hr to 5000/hr)
# Generate at: https://github.com/settings/tokens (no scopes needed for public data)
# GITHUB_API_TOKEN=

# =============================================================================
# Observability
# =============================================================================
# Langfuse (LLM monitoring)
# Get keys from: https://cloud.langfuse.com
# LANGFUSE_PUBLIC_KEY=
# LANGFUSE_SECRET_KEY=
LANGFUSE_HOST=https://cloud.langfuse.com

# Sentry (error tracking)
# Get DSN from: https://sentry.io
# SENTRY_DSN=

# =============================================================================
# Rate Limiting
# =============================================================================
RATE_LIMIT_REQUESTS_PER_MINUTE=100
RATE_LIMIT_SCORING_PER_MINUTE=10

# =============================================================================
# CORS Settings
# =============================================================================
CORS_ORIGINS=["http://localhost:3000","http://localhost:5173"]
